---
phase: 06-blog-engine
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - src/components/blog/PostCard.astro
  - src/components/blog/PostListRow.astro
  - src/components/blog/Pagination.astro
  - src/pages/blog/[...page].astro
autonomous: true

must_haves:
  truths:
    - "User can view a blog listing page showing all published posts"
    - "User sees preview cards for the first 6 posts in a responsive grid"
    - "User sees remaining posts as simple list rows below the grid"
    - "User can navigate between paginated pages"
  artifacts:
    - path: "src/components/blog/PostCard.astro"
      provides: "Blog post preview card for grid"
      min_lines: 30
    - path: "src/components/blog/PostListRow.astro"
      provides: "Simple list row for older posts"
      min_lines: 15
    - path: "src/components/blog/Pagination.astro"
      provides: "Numbered pagination navigation"
      min_lines: 20
    - path: "src/pages/blog/[...page].astro"
      provides: "Paginated blog listing page"
      contains: "getStaticPaths"
  key_links:
    - from: "src/pages/blog/[...page].astro"
      to: "astro:content"
      via: "getCollection"
      pattern: "getCollection.*blog"
    - from: "src/components/blog/PostCard.astro"
      to: "/blog/"
      via: "href link"
      pattern: "href=.*blog"
---

<objective>
Build the blog listing page with card grid, list rows, and pagination components.

Purpose: Enables users to browse all blog posts with visual preview cards and navigate through pages.
Output: Working /blog page with 3x2 grid (first 6 posts), list rows (remaining), and numbered pagination.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-blog-engine/06-CONTEXT.md
@.planning/phases/06-blog-engine/06-RESEARCH.md
@.planning/phases/06-blog-engine/06-01-SUMMARY.md

@src/content.config.ts
@src/utils/formatDate.ts
@src/layouts/PageLayout.astro
@src/components/ui/Button.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PostCard and PostListRow components</name>
  <files>
    src/components/blog/PostCard.astro
    src/components/blog/PostListRow.astro
  </files>
  <action>
    1. Create src/components/blog/ directory

    2. Create PostCard.astro:
       - Props: post (CollectionEntry<'blog'>)
       - Import Image from 'astro:assets' for featured images
       - Import formatPostDate from '@/utils/formatDate'
       - Layout:
         - Link wrapping entire card (a href="/blog/{post.id}")
         - If featuredImage exists: Square aspect ratio image (aspect-square object-cover)
         - If no featuredImage: No image area shown (just title/date/category)
         - Title (font-display, text-lg or xl, font-bold)
         - Date (text-surface-500, use formatPostDate)
         - Category badge (subtle, text-sm, surface colors)
       - Styling:
         - Card with rounded-lg, surface background
         - Hover state: thicker border (border-2 transition)
         - Dark mode: dark:bg-surface-800
       - Responsive: Component is used in grid, doesn't control its own width

    3. Create PostListRow.astro:
       - Props: post (CollectionEntry<'blog'>)
       - Import formatPostDate
       - Layout: Simple row with title + date
         - Title as link (text-accent-600 hover:underline)
         - Date on the right (text-surface-500, text-sm)
       - Styling:
         - py-3 for vertical padding
         - flex justify-between items-center
         - Designed to work inside a divide-y container
  </action>
  <verify>
    - Both components exist in src/components/blog/
    - Components have correct imports (astro:assets, formatDate)
    - TypeScript compiles: npx astro check
  </verify>
  <done>
    PostCard renders grid cards with optional images, PostListRow renders simple title+date rows.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Pagination component</name>
  <files>
    src/components/blog/Pagination.astro
  </files>
  <action>
    Create Pagination.astro:
    - Props: page (from Astro's paginate - has currentPage, lastPage, url.prev, url.next, etc.)
    - Layout:
      - Centered flex container with gap
      - Previous arrow/button (disabled styling if page 1)
      - Numbered page links (1, 2, 3...)
      - Next arrow/button (disabled styling if last page)
    - Styling:
      - Page numbers: rounded buttons with hover/active states
      - Current page: accent background, white text
      - Other pages: surface background, hover state
      - Arrows: Use simple < and > or chevron icons
      - Disabled: opacity-50 pointer-events-none
    - Use href for links (not buttons) for SSG compatibility
    - URLs: page.url.prev, page.url.next, or construct /blog, /blog/2, etc.
    - Don't show pagination if only 1 page (page.lastPage === 1)
  </action>
  <verify>
    - Component renders page numbers correctly
    - Current page is visually distinct
    - Prev/Next are disabled appropriately
    - Links use correct href values
  </verify>
  <done>
    Pagination component handles numbered navigation between blog pages.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create blog listing page</name>
  <files>
    src/pages/blog/[...page].astro
  </files>
  <action>
    Create [...page].astro (rest parameter for /blog, /blog/2, etc.):

    1. Imports:
       - getCollection from 'astro:content'
       - PageLayout from '@layouts/PageLayout.astro'
       - PostCard, PostListRow, Pagination from '@components/blog/'

    2. getStaticPaths:
       ```typescript
       export async function getStaticPaths({ paginate }) {
         const posts = (await getCollection('blog'))
           .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
         return paginate(posts, { pageSize: 20 });
       }
       ```

    3. Component script:
       - Get page from Astro.props
       - Split posts: gridPosts = page.data.slice(0, 6), listPosts = page.data.slice(6)

    4. Layout structure:
       - PageLayout with title="Blog" and appropriate description
       - Page header: "Blog" title with subtitle about photography stories
       - Grid section: 3x2 responsive grid (grid-cols-1 md:grid-cols-2 lg:grid-cols-3)
         - Map gridPosts to PostCard components
       - List section (if listPosts.length > 0):
         - Divider styling (divide-y divide-surface-200 dark:divide-surface-700)
         - Map listPosts to PostListRow components
       - Pagination component at bottom (with mt-8 spacing)
       - Show empty state if no posts (edge case for testing)

    5. Container styling:
       - Use consistent max-w and padding from other pages
       - Appropriate spacing between sections
  </action>
  <verify>
    - npm run dev and navigate to /blog
    - Sample posts appear in grid
    - Grid is responsive (3 cols -> 2 cols -> 1 col)
    - Date formatting shows relative dates for recent posts
    - Page builds: npm run build
  </verify>
  <done>
    Blog listing page shows posts in grid + list format with pagination.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Visit /blog - page loads with sample posts
2. Grid layout is responsive (resize browser)
3. Post cards show title, date, category
4. Date format is relative ("X days ago") for recent posts
5. Pagination is hidden (only 2 sample posts, under 20)
6. Build succeeds: npm run build
</verification>

<success_criteria>
- PostCard renders with optional featured image, title, date, category
- PostListRow renders title + date in simple row format
- Pagination shows numbered navigation (hidden when single page)
- Blog listing page at /blog shows grid of posts
- Posts sorted by date (newest first)
- Responsive grid: 3 cols desktop, 2 tablet, 1 mobile
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/06-blog-engine/06-02-SUMMARY.md`
</output>
