---
phase: 06-blog-engine
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/styles/global.css
  - src/content.config.ts
  - src/data/authors.ts
  - src/utils/formatDate.ts
  - src/content/blog/sample-outdoor-session.md
  - src/content/blog/sample-wedding-behind-scenes.md
autonomous: true

must_haves:
  truths:
    - "Content collection schema validates blog post frontmatter"
    - "Typography plugin renders prose styles"
    - "Date utility formats relative and absolute dates correctly"
  artifacts:
    - path: "src/content.config.ts"
      provides: "Blog content collection schema"
      contains: "defineCollection"
    - path: "src/data/authors.ts"
      provides: "Author metadata"
      exports: ["Author", "authors", "getAuthorById"]
    - path: "src/utils/formatDate.ts"
      provides: "Date formatting utility"
      exports: ["formatPostDate"]
    - path: "src/content/blog/"
      provides: "Sample blog posts for testing"
      min_files: 2
  key_links:
    - from: "src/content.config.ts"
      to: "src/content/blog/"
      via: "glob loader"
      pattern: "glob.*blog"
---

<objective>
Set up blog content infrastructure with Astro content collections, author data module, date formatting utility, and typography plugin.

Purpose: Establishes the data layer and styling foundation that all blog components and pages depend on.
Output: Working content collection, author data, date utility, and 2 sample posts for testing.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-blog-engine/06-CONTEXT.md
@.planning/phases/06-blog-engine/06-RESEARCH.md

@src/data/services.ts
@src/styles/global.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and configure typography plugin</name>
  <files>
    package.json
    src/styles/global.css
  </files>
  <action>
    1. Install dependencies:
       ```bash
       npm install @tailwindcss/typography date-fns
       ```

    2. Add typography plugin to global.css AFTER the @import "tailwindcss" line:
       ```css
       @plugin "@tailwindcss/typography";
       ```
       Place it right after the @import, before @custom-variant.
  </action>
  <verify>
    - npm ls @tailwindcss/typography shows installed
    - npm ls date-fns shows installed
    - global.css contains @plugin "@tailwindcss/typography"
  </verify>
  <done>
    Typography plugin installed and configured in CSS-first Tailwind v4 style.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create content collection config, author data, and date utility</name>
  <files>
    src/content.config.ts
    src/data/authors.ts
    src/utils/formatDate.ts
  </files>
  <action>
    1. Create src/content.config.ts (NOTE: at src/ level, NOT src/content/):
       - Import defineCollection from 'astro:content'
       - Import glob from 'astro/loaders'
       - Import z from 'astro/zod'
       - Define blog collection with glob loader for src/content/blog/*.md
       - Schema fields:
         - title: z.string() (required)
         - date: z.coerce.date() (required)
         - category: z.string() (required, matches service slugs)
         - tags: z.array(z.string()).optional()
         - featuredImage: image().optional()
         - featuredImageAlt: z.string().optional()
         - galleryUrl: z.string().url().optional()
         - author: z.string().default('simon')
       - Export collections (plural!) object with blog

    2. Create src/data/authors.ts following services.ts pattern:
       - Author interface: id, name, bio, photo (optional string)
       - authors array with Simon as default author
       - getAuthorById helper function

    3. Create src/utils/formatDate.ts:
       - Import formatDistanceToNow, differenceInDays, format from 'date-fns'
       - formatPostDate(date: Date): string
         - If <= 15 days ago: return formatDistanceToNow(date, { addSuffix: true })
         - Else: return format(date, 'MMMM d, yyyy')
  </action>
  <verify>
    - src/content.config.ts exists and exports collections
    - src/data/authors.ts exports Author, authors, getAuthorById
    - src/utils/formatDate.ts exports formatPostDate
    - TypeScript compiles: npx astro check (may have pre-existing warnings, check for new errors)
  </verify>
  <done>
    Content collection schema, author data module, and date utility are in place.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create sample blog posts</name>
  <files>
    src/content/blog/sample-outdoor-session.md
    src/content/blog/sample-wedding-behind-scenes.md
  </files>
  <action>
    1. Create src/content/blog/ directory

    2. Create sample-outdoor-session.md:
       ```markdown
       ---
       title: "Golden Hour Magic at Papago Park"
       date: 2026-02-08
       category: outdoor-portraits
       tags: ["Arizona", "golden hour", "family"]
       author: simon
       ---

       There's something special about the light at Papago Park during golden hour...

       ## The Location

       Papago Park offers incredible red rock formations that create a stunning backdrop for portraits.

       ## Working with Natural Light

       We scheduled the session for 5:30 PM to catch the golden hour light filtering through the desert landscape.

       ### Tips for Outdoor Sessions

       - Book sessions 1-2 hours before sunset
       - Wear colors that complement the environment
       - Comfortable shoes for walking to the best spots

       The Smith family was wonderful to work with, and we captured some truly magical moments.
       ```

    3. Create sample-wedding-behind-scenes.md:
       ```markdown
       ---
       title: "Behind the Scenes: Sarah & James's Desert Wedding"
       date: 2026-02-05
       category: weddings
       tags: ["behind the scenes", "desert", "ceremony"]
       galleryUrl: "https://simonwickes.pic-time.com/gallery/sample"
       author: simon
       ---

       Every wedding tells a unique story. Sarah and James chose to celebrate their love surrounded by the Arizona desert...

       ## The Venue

       The ceremony took place at a stunning desert venue just outside Scottsdale.

       ## Capturing the Day

       From the quiet moments of preparation to the joyful celebration, here's how the day unfolded.

       ### Morning Preparations

       We started early, documenting both Sarah and James as they prepared for the big day.

       ### The Ceremony

       As the sun began to set, the ceremony began with the most beautiful desert light.

       > "The photos captured exactly how we felt that day." - Sarah

       ## View the Full Gallery

       Ready to see more? [View the full gallery](https://simonwickes.pic-time.com/gallery/sample) to explore all the moments from this beautiful day.
       ```
  </action>
  <verify>
    - Both .md files exist in src/content/blog/
    - npm run build succeeds (content collection validates posts)
    - No schema validation errors in build output
  </verify>
  <done>
    Two sample blog posts exist with different categories, tags, and one with galleryUrl.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run build` succeeds without content collection errors
2. Content collection types are generated (check .astro/types.d.ts for blog collection types)
3. Date utility tested manually or via quick TypeScript check
</verification>

<success_criteria>
- @tailwindcss/typography and date-fns are installed
- Typography plugin configured in global.css
- Content collection schema defined in src/content.config.ts
- Author data module follows established pattern
- Date utility handles 15-day threshold
- Two sample posts validate against schema
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/06-blog-engine/06-01-SUMMARY.md`
</output>
