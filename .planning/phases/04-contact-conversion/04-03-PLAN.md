---
phase: 04-contact-conversion
plan: 03
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - src/components/contact/ContactForm.astro
  - src/pages/contact.astro
autonomous: true

must_haves:
  truths:
    - "User can submit a contact form with name, email, message, and optional event type and date"
    - "User sees clear success confirmation after submitting the form"
    - "User sees inline validation errors under invalid fields"
    - "User sees an expected response time indication"
    - "Event type dropdown includes all 8 service categories plus Other with free text"
    - "Submit button shows spinner and is disabled during submission"
  artifacts:
    - path: "src/components/contact/ContactForm.astro"
      provides: "Contact form with all fields, client-side submission, inline feedback"
      min_lines: 80
    - path: "src/pages/contact.astro"
      provides: "Contact page with form component and response time info"
      min_lines: 20
  key_links:
    - from: "src/components/contact/ContactForm.astro"
      to: "astro:actions"
      via: "client-side action call"
      pattern: "import.*actions.*from.*astro:actions"
    - from: "src/components/contact/ContactForm.astro"
      to: "astro:actions"
      via: "isInputError for field-level errors"
      pattern: "isInputError"
    - from: "src/pages/contact.astro"
      to: "src/components/contact/ContactForm.astro"
      via: "component import"
      pattern: "import ContactForm"
---

<objective>
Build the contact form UI component with all fields, client-side submission to the Astro Action, inline validation errors, success/error states, and compose the contact page with the form, response time indication, and link to FAQ.

Purpose: This is the user-facing contact form that connects to the server action from Plan 01. Users can inquire about photography services with full feedback on submission status.
Output: ContactForm.astro component with complete client-side interaction, and updated contact.astro page.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-contact-conversion/04-CONTEXT.md
@.planning/phases/04-contact-conversion/04-RESEARCH.md
@.planning/phases/04-contact-conversion/04-01-SUMMARY.md
@src/actions/index.ts
@src/data/services.ts
@src/pages/contact.astro
@src/layouts/PageLayout.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ContactForm component with full client-side interaction</name>
  <files>src/components/contact/ContactForm.astro</files>
  <action>
Create `src/components/contact/ContactForm.astro` with the following structure:

**Form HTML (the template portion):**

1. Form element with `id="contact-form"` and `class="space-y-6"`:

2. Two-column row on desktop for name + email:
   ```
   <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
     <!-- Name field -->
     <!-- Email field -->
   </div>
   ```

3. Each form field follows this pattern (reuse inline, no separate component needed since there are only 5 fields):
   ```html
   <div>
     <label for="name" class="mb-1 block text-sm font-medium text-surface-700 dark:text-surface-300">
       Name <span class="text-red-500">*</span>
     </label>
     <input
       type="text"
       id="name"
       name="name"
       required
       class="w-full rounded-lg border border-surface-300 bg-white px-4 py-2.5 text-surface-900
              transition-colors focus:border-accent-500 focus:outline-none focus:ring-2 focus:ring-accent-500/20
              dark:border-surface-700 dark:bg-surface-900 dark:text-surface-100"
       placeholder="Your name"
     />
     <p data-error="name" class="field-error mt-1 text-sm text-red-500"></p>
   </div>
   ```

4. Fields in order:
   - **Name** (text input, required) + **Email** (email input, required) -- side by side on sm+
   - **Event Type** (select dropdown, optional): Options are empty default ("Select an event type..."), then all 8 service categories from services.ts (Outdoor Portraits, Weddings, Commercial, Landscape, Cars, Assignments, Events, Live Performances), plus "Other". Import `services` from `@/data/services` to generate options dynamically.
   - **Event Type Other** (text input, optional): Wrapped in a div with `id="other-type-wrapper"` and `class="hidden"`. Shown via JS when "other" is selected in the dropdown.
   - **Event Date** (text input, NOT date picker -- for cross-browser safety): `placeholder="e.g., March 15, 2026"`, optional
   - **Message** (textarea, required, min 10 chars): `rows="5"`, full width

5. Submit button:
   ```html
   <button type="submit" id="submit-btn"
     class="inline-flex items-center justify-center gap-2 rounded-lg bg-accent-500 px-8 py-3
            font-semibold text-white transition-colors hover:bg-accent-600
            disabled:cursor-not-allowed disabled:opacity-50
            dark:bg-accent-400 dark:text-surface-950 dark:hover:bg-accent-300">
     <span id="btn-text">Send Message</span>
     <svg id="btn-spinner" class="hidden h-5 w-5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
       <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
       <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
     </svg>
   </button>
   ```

6. Success message div (hidden by default, replaces form on success):
   ```html
   <div id="success-message" class="hidden rounded-lg border border-green-200 bg-green-50 p-8 text-center dark:border-green-800 dark:bg-green-950">
     <svg class="mx-auto mb-4 h-12 w-12 text-green-500" ...><!-- checkmark icon --></svg>
     <h3 class="mb-2 font-display text-xl font-bold text-surface-900 dark:text-surface-100">Message Sent!</h3>
     <p class="text-surface-600 dark:text-surface-400">
       Thanks for reaching out. I'll get back to you within 24-48 hours.
     </p>
   </div>
   ```

7. General error message div (hidden by default, shown on server errors):
   ```html
   <div id="error-message" class="hidden rounded-lg border border-red-200 bg-red-50 p-4 text-red-700 dark:border-red-800 dark:bg-red-950 dark:text-red-300">
     <p id="error-text">Something went wrong. Please try again.</p>
   </div>
   ```

**Client-side script (inside a `<script>` tag):**

```typescript
import { actions, isInputError } from 'astro:actions';

const form = document.getElementById('contact-form') as HTMLFormElement;
const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
const btnText = document.getElementById('btn-text')!;
const btnSpinner = document.getElementById('btn-spinner')!;
const successMsg = document.getElementById('success-message')!;
const errorMsg = document.getElementById('error-message')!;
const errorText = document.getElementById('error-text')!;
const eventTypeSelect = document.getElementById('eventType') as HTMLSelectElement;
const otherWrapper = document.getElementById('other-type-wrapper')!;
```

Event listeners:
- `eventTypeSelect.addEventListener('change', ...)`: Toggle `hidden` class on otherWrapper based on whether value is 'other'.
- `form.addEventListener('submit', async (e) => { ... })`:
  1. `e.preventDefault()`
  2. Clear all field errors (querySelectorAll('.field-error') and set textContent to '')
  3. Hide error message div
  4. Disable submit button, hide btn-text, show btn-spinner
  5. `const formData = new FormData(form)`
  6. `const { data, error } = await actions.submitContact(formData)`
  7. Re-enable button (show btn-text, hide btn-spinner, enable button)
  8. If error:
     - If `isInputError(error)`: iterate `error.fields`, set `data-error="{fieldName}"` element text to first message
     - Else: show error-message div with `error.message`
  9. If success: hide form, show success-message div

IMPORTANT:
- Do NOT use `client:load` or any framework directive -- this is a plain Astro component with a `<script>` tag
- Import services data in the frontmatter for generating dropdown options: `import { services } from '@/data/services'`
- The script uses Astro's built-in module script handling (bundled, not inline)
  </action>
  <verify>
- File exists at `src/components/contact/ContactForm.astro`
- Contains form with all 5 fields (name, email, eventType, eventDate, message) plus eventTypeOther
- Contains `<script>` with `import { actions, isInputError } from 'astro:actions'`
- Event type dropdown options are generated from services data
- Success and error message divs exist with proper IDs
- Submit button has spinner SVG
- `npm run build` succeeds (no TypeScript or import errors)
  </verify>
  <done>ContactForm.astro component has all required fields, client-side action submission, inline validation errors per field, spinner on submit button, and success/error message states.</done>
</task>

<task type="auto">
  <name>Task 2: Compose the contact page with form, response time, and FAQ link</name>
  <files>src/pages/contact.astro</files>
  <action>
Replace the placeholder content in `src/pages/contact.astro` with the full contact page:

1. Import ContactForm component from `@components/contact/ContactForm.astro`.

2. Page structure inside PageLayout (keep existing title="Contact" and description):
   ```
   <section class="mx-auto max-w-4xl px-6 py-16">
     <h1> -- "Get in Touch" (font-display, text-4xl, font-bold, tracking-tight, mb-4)
     <p class="mb-2 text-lg text-surface-600 dark:text-surface-400">
       Interested in booking a session or have a question about my services?
       Fill out the form below and I'll get back to you within 24-48 hours.
     </p>
     <p class="mb-10 text-sm text-surface-500 dark:text-surface-500">
       Check out the <a href="/faq/" class="text-accent-500 hover:text-accent-600 underline dark:text-accent-400 dark:hover:text-accent-300">FAQ</a>
       for answers to common questions.
     </p>

     <ContactForm />
   </section>
   ```

3. The response time indication ("I'll get back to you within 24-48 hours") is included in the intro paragraph above the form AND in the success message inside ContactForm. This satisfies CONT-06.

4. Remove all placeholder content (the "Contact form coming in Phase 4" text and the Instagram link).
  </action>
  <verify>
- `npm run build` succeeds
- `/contact/` page renders with the form in dev server
- Page heading says "Get in Touch"
- Response time (24-48 hours) is mentioned in intro text
- Link to /faq/ is present
- No placeholder text remains
  </verify>
  <done>Contact page displays the ContactForm component with intro text including response time (24-48 hours) and link to FAQ page. All placeholder content removed.</done>
</task>

</tasks>

<verification>
- `npm run build` succeeds
- Contact page at /contact/ renders with full form
- All form fields present: name, email, event type (with Other), event date, message
- Submit button exists with spinner SVG
- Success and error message containers exist (hidden by default)
- Response time mentioned in page intro
- FAQ link present on contact page
</verification>

<success_criteria>
- ContactForm.astro component has all 5 fields + Other text input
- Event type dropdown populated from services.ts data + Other option
- Client-side script calls actions.submitContact and handles success/error/validation
- Submit button has spinner + disabled state during submission
- Inline field errors display under each field
- Success message replaces form with "24-48 hours" response time
- Contact page has intro text with response time and FAQ link
</success_criteria>

<output>
After completion, create `.planning/phases/04-contact-conversion/04-03-SUMMARY.md`
</output>
