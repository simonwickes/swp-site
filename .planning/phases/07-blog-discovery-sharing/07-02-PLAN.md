---
phase: 07-blog-discovery-sharing
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/blog/ShareButtons.astro
  - src/pages/blog/[id].astro
autonomous: true

must_haves:
  truths:
    - "User can share a blog post on X (Twitter) via share button"
    - "User can share a blog post on Facebook via share button"
    - "User can copy the blog post link to clipboard with visual feedback"
    - "Instagram button copies link to clipboard with explanatory feedback"
    - "Share buttons appear at the end of post content, before related posts sidebar"
  artifacts:
    - path: "src/components/blog/ShareButtons.astro"
      provides: "Social share buttons (X, Facebook, Instagram, Copy Link)"
      contains: "twitter.com/intent"
    - path: "src/pages/blog/[id].astro"
      provides: "Blog post page with share buttons integrated"
      contains: "ShareButtons"
  key_links:
    - from: "src/components/blog/ShareButtons.astro"
      to: "navigator.clipboard"
      via: "client-side script for copy/Instagram"
      pattern: "navigator\\.clipboard\\.writeText"
    - from: "src/pages/blog/[id].astro"
      to: "src/components/blog/ShareButtons.astro"
      via: "component import and render"
      pattern: "import ShareButtons"
---

<objective>
Create social share buttons component and integrate it into blog post pages.

Purpose: Enables users to share blog posts on X, Facebook, and Instagram (via clipboard copy), and copy the direct link. This is an independent feature from search/filtering and can be built in parallel.

Output: `ShareButtons.astro` component with 4 share actions, wired into `[id].astro` post pages at the end of post content.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-blog-discovery-sharing/07-CONTEXT.md
@.planning/phases/07-blog-discovery-sharing/07-RESEARCH.md

@src/pages/blog/[id].astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ShareButtons component</name>
  <files>src/components/blog/ShareButtons.astro</files>
  <action>
Create `src/components/blog/ShareButtons.astro` with these requirements:

**Props interface:**
```typescript
interface Props {
  url: string;   // Full canonical URL of the post
  title: string; // Post title for share text
}
```

**Layout:**
- A horizontal flex row with icon-only buttons, gap-3
- Label text "Share" preceding the buttons in subtle style
- Compact, minimal style per CONTEXT.md decision

**Share buttons (4 total, icon-only):**

1. **X (Twitter)** -- `<a>` tag
   - href: `https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}`
   - target="_blank" rel="noopener noreferrer"
   - aria-label="Share on X"
   - SVG icon: X/Twitter logo (simple path)

2. **Facebook** -- `<a>` tag
   - href: `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`
   - target="_blank" rel="noopener noreferrer"
   - aria-label="Share on Facebook"
   - SVG icon: Facebook logo (simple path)

3. **Instagram** -- `<button>` tag
   - data-share-instagram attribute
   - aria-label="Share on Instagram"
   - SVG icon: Instagram logo (simple path)
   - On click: copies URL to clipboard and shows tooltip "Link copied! Paste on Instagram"

4. **Copy Link** -- `<button>` tag
   - data-copy-link attribute
   - aria-label="Copy link"
   - SVG icon: link/chain icon
   - On click: copies URL to clipboard and shows brief "Copied!" feedback

**Icon styling:**
- Size: w-5 h-5 for SVG icons inside w-9 h-9 flex centered buttons
- Color: `text-surface-500 dark:text-surface-400 hover:text-accent-500 dark:hover:text-accent-400 transition-colors`
- Buttons should have `rounded-full hover:bg-surface-100 dark:hover:bg-surface-800` background on hover

**Client-side script (`<script>` tag):**
- Use `document.querySelectorAll` (class selectors, not IDs)
- Instagram button handler: `navigator.clipboard.writeText(url)` then change aria-label to "Link copied! Paste on Instagram" and add a temporary `text-green-500` class. Reset after 2 seconds.
- Copy link button handler: same clipboard pattern, aria-label changes to "Copied!", green feedback, reset after 2 seconds.
- Fallback: if clipboard API fails, use `prompt("Copy this link:", url)` pattern.
- Use `DOMContentLoaded` + `astro:page-load` pattern for View Transitions safety (per 03-03 decision).

Encode URL and title using `encodeURIComponent()` in the frontmatter section.
  </action>
  <verify>
1. File exists at `src/components/blog/ShareButtons.astro`
2. Contains X share URL with twitter.com/intent pattern
3. Contains Facebook share URL with sharer.php pattern
4. Contains client-side script with navigator.clipboard.writeText
5. `npm run build` succeeds
  </verify>
  <done>
ShareButtons component renders 4 icon-only share buttons (X, Facebook, Instagram, Copy Link) with proper share URLs and clipboard copy functionality with visual feedback.
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate ShareButtons into blog post pages</name>
  <files>src/pages/blog/[id].astro</files>
  <action>
Modify `src/pages/blog/[id].astro` to add ShareButtons after the post content.

Changes:
1. Add import: `import ShareButtons from "@components/blog/ShareButtons.astro";`

2. Construct the canonical URL for the post:
   ```typescript
   const canonicalUrl = `${Astro.site ?? "https://simonwickes.com"}/blog/${post.id}/`;
   ```

3. Insert `<ShareButtons>` between the Gallery CTA section and the closing `</div>` of the main content area. Place it after the gallery CTA `{post.data.galleryUrl && ...}` block and before the closing `</div>` of `<div class="flex-1 min-w-0">`.

4. Wrap it in a styled container:
   ```astro
   {/* Share buttons */}
   <div class="mt-8 pt-6 border-t border-surface-200 dark:border-surface-700">
     <ShareButtons url={canonicalUrl} title={post.data.title} />
   </div>
   ```

5. Do NOT modify any other part of the page. The sidebar, header, prose, and gallery CTA all stay exactly as they are.
  </action>
  <verify>
1. `npm run build` succeeds
2. Check the built HTML for a blog post page contains share button markup (twitter.com/intent, sharer.php)
3. Run `npm run dev` and visit a blog post -- share buttons visible at end of content
  </verify>
  <done>
Every blog post page shows share buttons (X, Facebook, Instagram, Copy Link) at the end of post content, before the sidebar. Share links use the correct canonical URL and post title.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Blog post pages contain ShareButtons with correct share URLs
3. X share link opens twitter.com/intent with post title and URL
4. Facebook share link opens facebook.com/sharer/sharer.php with post URL
5. Copy link and Instagram buttons use clipboard API
</verification>

<success_criteria>
- ShareButtons component exists with 4 share actions (X, Facebook, Instagram copy, Copy Link)
- Share buttons appear on every blog post page at end of content
- Share URLs are correctly encoded with post title and canonical URL
- Clipboard copy provides visual feedback (green color + label change for 2 seconds)
</success_criteria>

<output>
After completion, create `.planning/phases/07-blog-discovery-sharing/07-02-SUMMARY.md`
</output>
